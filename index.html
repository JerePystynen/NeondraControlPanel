<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neondra Control Panel</title>
    <link rel="shortcut icon" href="https://neondra.com/neondra/assets/images/logo/favicon.png" type="image/x-icon">
    <link rel="stylesheet" href="./style.css">
    <script async src="https://unpkg.com/es-module-shims@1.6.3/dist/es-module-shims.js"></script>
    <script type="importmap">
    {
        "imports": {
            "three": "https://unpkg.com/three/build/three.module.js",
            "three/addons/": "https://unpkg.com/three/examples/jsm/"
        }
    }
    </script>
    <!-- Color Picker -->
    <script src='https://cdn.jsdelivr.net/npm/@jaames/iro/dist/iro.min.js'></script>
</head>
<body class="flex-wrap">
    <svg class="top-svg-element" width="1920" viewBox="0 0 1921 131" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M116.261 130.176H0V3.05176e-05H1921V130.176H1803.84L1674.5 41.0785H208.045L116.261 130.176Z" fill="#261d46"/>
    </svg>
    <svg class="bottom-svg-element" width="1920" viewBox="0 0 1921 165" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M116.73 34.8241H0.5V165H1921V34.8241H1803.87L1705.61 92.8643H1244.69L1120.07 0H781.361L656.743 92.8643H177.442L116.73 34.8241Z" fill="#261d46"/>
    </svg>
    
    <nav>
        <span>Welcome to Neondra's control panel v2.3, powered by an ESP8266!</span>
    </nav>

    <section>
        <div class="status-info-container">
            <div class="item">
                <span class="circle a"></span> <!-- Blurry halo -->
                <span class="circle b"></span> <!-- Dual-ring solid -->
                <span class="circle c"></span> <!-- Dual-ring solid -->
                <span class="circle d"></span> <!-- Dotted -->
                <span class="circle e"></span> <!-- Blurry halo -->
                <span class="circle f"></span> <!-- Solid by percentage 1-100 -->
                <span>Battery</span>
                <span class="status" id="status-battery-percentage">64 %</span>
                <span id="status-battery-remaining">2.3 h</span>
            </div>
            <div class="item">
                <span class="circle a"></span> <!-- Blurry halo -->
                <span class="circle b"></span> <!-- Dual-ring solid -->
                <span class="circle c"></span> <!-- Dual-ring solid -->
                <span class="circle d"></span> <!-- Dotted -->
                <span class="circle e"></span> <!-- Blurry halo -->
                <span class="circle f"></span> <!-- Solid by percentage 1-100 -->
                <span>Volts</span>
                <span class="status" id="status-battery-voltage">11.2</span>
                <span>V</span>
            </div>
            <div class="item">
                <span class="circle a"></span> <!-- Blurry halo -->
                <span class="circle b"></span> <!-- Dual-ring solid -->
                <span class="circle c"></span> <!-- Dual-ring solid -->
                <span class="circle d"></span> <!-- Dotted -->
                <span class="circle e"></span> <!-- Blurry halo -->
                <span class="circle f"></span> <!-- Solid by percentage 1-100 -->
                <span>Amps</span>
                <span class="status" id="status-battery-amperage">1249</span>
                <span>mAh</span>                        
            </div>
            <div class="item">
                <span class="circle a"></span> <!-- Blurry halo -->
                <span class="circle b"></span> <!-- Dual-ring solid -->
                <span class="circle c"></span> <!-- Dual-ring solid -->
                <span class="circle d"></span> <!-- Dotted -->
                <span class="circle e"></span> <!-- Blurry halo -->
                <span class="circle f"></span> <!-- Solid by percentage 1-100 -->
                <span>Volume</span>
                <span class="status" id="status-audiofile-volume">35 %</span>
                <span id="status-audiofile-volume-decibels">-2 dB</span>
            </div>
        </div>
        <div class="status-connections-container">
            <div class="item" title="Status: Connected" connected="true">
                <span class="circle a"></span> <!-- Blurry halo -->
                <span class="circle b"></span> <!-- Dual-ring solid -->
                <span class="circle c"></span> <!-- Dual-ring solid -->
                <span class="circle d"></span> <!-- Dotted -->
                <span class="circle e"></span> <!-- Blurry halo -->
                <span>Torso</span>
            </div>
            <div class="item" title="Status: Disconnected" connected="false">
                <span class="circle a"></span> <!-- Blurry halo -->
                <span class="circle b"></span> <!-- Dual-ring solid -->
                <span class="circle c"></span> <!-- Dual-ring solid -->
                <span class="circle d"></span> <!-- Dotted -->
                <span class="circle e"></span> <!-- Blurry halo -->
                <span>Wings</span>
            </div>
            <div class="item" title="Status: Connected" connected="true">
                <span class="circle a"></span> <!-- Blurry halo -->
                <span class="circle b"></span> <!-- Dual-ring solid -->
                <span class="circle c"></span> <!-- Dual-ring solid -->
                <span class="circle d"></span> <!-- Dotted -->
                <span class="circle e"></span> <!-- Blurry halo -->
                <span>Claws</span>
            </div>
            <div class="item" title="Status: Disconnected" connected="false">
                <span class="circle a"></span> <!-- Blurry halo -->
                <span class="circle b"></span> <!-- Dual-ring solid -->
                <span class="circle c"></span> <!-- Dual-ring solid -->
                <span class="circle d"></span> <!-- Dotted -->
                <span class="circle e"></span> <!-- Blurry halo -->
                <span>Legs</span>
            </div>
            <div class="item" title="Status: Disconnected" connected="false">
                <span class="circle a"></span> <!-- Blurry halo -->
                <span class="circle b"></span> <!-- Dual-ring solid -->
                <span class="circle c"></span> <!-- Dual-ring solid -->
                <span class="circle d"></span> <!-- Dotted -->
                <span class="circle e"></span> <!-- Blurry halo -->
                <span>Spitfire</span>
            </div>
        </div>
    </section>

    <section class="center-control-panel">
        <div class="left">
            <div class="flex-wrap">
                <img src="./img/helmet.png" alt="The Helmet" title="The Helmet's Configuration">
                <a class="button small-icon" selected="false" onclick="sendData('set-helmet=vumeter');">
                    <img src="./img/audiovisualizer.png" alt="Music Visualizer" title="Music Visualizer">
                </a>
                <a class="button small-icon" selected="false" onclick="sendData('set-helmet=datetime');">
                    <img src="./img/calendar.png" alt="Datetime" title="Datetime">
                </a>
                <a class="button small-icon" selected="false" onclick="sendData('set-helmet=subcount');">
                    <img src="./img/subscribers.png" alt="Show the Subcount" title="Show the Subcount">
                </a>
                <a class="button small-icon" selected="false" onclick="sendData('set-animation-playstate=true');">
                    <img src="./img/play.png" alt="Play the Animation" title="Play the Animation">
                </a>
                <a class="button small-icon" selected="false" onclick="sendData('set-animation-playstate=false');">
                    <img src="./img/next.png" alt="Stop the Animation" title="Stop the Animation">
                </a>
            </div>
            <div>
                <h2>Mic Input</h2>
                <div class="flex-wrap">
                    <a class="button small-icon" selected="false" onclick="sendData('set-helmet=vumeter');">
                        <img src="./img/audiovisualizer.png" alt="Music Visualizer" title="Music Visualizer">
                    </a>
                    <a class="button small-icon" selected="false" onclick="sendData('set-helmet=datetime');">
                        <img src="./img/calendar.png" alt="Datetime" title="Datetime">
                    </a>
                    <a class="button small-icon" selected="false" onclick="sendData('set-helmet=subcount');">
                        <img src="./img/subscribers.png" alt="Show the Subcount" title="Show the Subcount">
                    </a>
                    <a class="button small-icon" selected="false" onclick="sendData('set-animation-playstate=true');">
                        <img src="./img/play.png" alt="Play the Animation" title="Play the Animation">
                    </a>
                    <a class="button small-icon" selected="false" onclick="sendData('set-animation-playstate=false');">
                        <img src="./img/next.png" alt="Stop the Animation" title="Stop the Animation">
                    </a>
                </div>
                <div class="flex-align">
                    <img src="./img/speaker.png" alt="Volume">
                    <span>Volume:</span>
                    <input type="range" min="0" max="100" value="50" class="slider" id="set-wing-volume">
                    <span>50%</span>
                </div>
            </div>
            <div class="flex-align">
                <img src="./img/speaker.png" alt="Volume">
                <span>Volume:</span>
                <input type="range" min="0" max="100" value="50" class="slider" id="set-helmet-volume">
                <span>50%</span>
            </div>
            <div class="flex-align">
                <img src="./img/fan.png" alt="Fan">
                <span>Fan Speed:</span>
                <input type="range" min="0" max="100" value="50" class="slider" id="set-helmet-fan">
                <span>50%</span>
            </div>
            <div class="flex-align">
                <img src="./img/brightness.png" alt="Brightness">
                <span>Mouth:</span>
                <input type="range" min="0" max="100" value="50" class="slider" id="set-helmet-brightness">
                <span>50%</span>
            </div>
            <div class="flex-align">
                <img src="./img/brightness.png" alt="Brightness">
                <span>Headband:</span>
                <input type="range" min="0" max="100" value="50" class="slider" id="set-helmet-brightness">
                <span>50%</span>
            </div>
            <div class="flex-align">
                <img src="./img/brightness.png" alt="Brightness">
                <span>Left Eye:</span>
                <input type="range" min="0" max="100" value="50" class="slider" id="set-helmet-brightness">
                <span>50%</span>
            </div>
            <div class="flex-align">
                <img src="./img/brightness.png" alt="Brightness">
                <span>Right Eye:</span>
                <input type="range" min="0" max="100" value="50" class="slider" id="set-helmet-brightness">
                <span>50%</span>
            </div>
            <div class="flex-align">
                <img src="./img/brightness.png" alt="Brightness">
                <span>Forehead:</span>
                <input type="range" min="0" max="100" value="50" class="slider" id="set-helmet-brightness">
                <span>50%</span>
            </div>
            <div class="flex-align">
                <img src="./img/brightness.png" alt="Brightness">
                <span>Rings:</span>
                <input type="range" min="0" max="100" value="50" class="slider" id="set-helmet-brightness">
                <span>50%</span>
            </div>
        </div>
        <div class="right">
            <div>
                <h2>Controls</h2>
                <h3>The Torso:</h3>
                <div class="flex-align">
                    <img src="./img/speaker.png" alt="Volume">
                    <span>Volume:</span>
                    <input type="range" min="0" max="100" value="50" class="slider" id="set-wing-volume">
                    <span>50%</span>
                </div>
                <div class="flex-align">
                    <img src="./img/brightness.png" alt="Brightness">
                    <span>Left Shoulder:</span>
                    <input type="range" min="0" max="100" value="50" class="slider" id="set-wing-brightness">
                    <span>50%</span>
                </div>
                <div class="flex-align">
                    <img src="./img/brightness.png" alt="Brightness">
                    <span>Right Shoulder:</span>
                    <input type="range" min="0" max="100" value="50" class="slider" id="set-wing-brightness">
                    <span>50%</span>
                </div>
                <div class="flex-align">
                    <img src="./img/brightness.png" alt="Brightness">
                    <span>Center:</span>
                    <input type="range" min="0" max="100" value="50" class="slider" id="set-helmet-brightness">
                    <span>50%</span>
                </div>
                <h3>The Wings:</h3>
                <div class="flex-align">
                    <img src="./img/motor.png" alt="Fan">
                    <span>Motor:</span>
                    <input type="range" min="0" max="100" value="50" class="slider" id="set-wings">
                    <span>50%</span>
                </div>
                <div class="flex-align">
                    <img src="./img/brightness.png" alt="Brightness">
                    <span>Tips:</span>
                    <input type="range" min="0" max="100" value="50" class="slider" id="set-wing-brightness">
                    <span>50%</span>
                </div>
                <div class="flex-align">
                    <img src="./img/speaker.png" alt="Volume">
                    <span>Volume:</span>
                    <input type="range" min="0" max="100" value="50" class="slider" id="set-wing-volume">
                    <span>50%</span>
                </div>
            </div>
        </div>
    </section>

    <section class="suit-mode-selection flex-wrap">
        <div class="flex-align">
            <a class="button small-icon" selected="false" onclick="sendData('set-emoji=wink1');"><img src="./img/love.png" alt="Emoji" title="Play Emoji: Love"></a>
            <a class="button small-icon" selected="false" onclick="sendData('set-emoji=wink1');"><img src="./img/love.png" alt="Emoji" title="Play Emoji: Love"></a>
            <a class="button small-icon" selected="false" onclick="sendData('set-emoji=wink1');"><img src="./img/love.png" alt="Emoji" title="Play Emoji: Love"></a>
            <a class="button small-icon" selected="false" onclick="sendData('set-emoji=wink1');"><img src="./img/love.png" alt="Emoji" title="Play Emoji: Love"></a>
            <a class="button small-icon" selected="false" onclick="sendData('set-emoji=wink1');"><img src="./img/love.png" alt="Emoji" title="Play Emoji: Love"></a>
            <a class="button small-icon" selected="false" onclick="sendData('set-emoji=wink1');"><img src="./img/love.png" alt="Emoji" title="Play Emoji: Love"></a>
        </div>
        <div>
            <div class="flex-align">
                <a class="button icon flex" selected="false" onclick="sendData('set-mode=default');"><img src="./img/default.png" alt="Default" title="Default"></a>
                <a class="button icon flex" selected="false" onclick="sendData('set-mode=love');"><img src="./img/love.png" alt="Love" title="Love"></a>
                <a class="button icon flex" selected="false" onclick="sendData('set-mode=fury');"><img src="./img/fury.png" alt="Fury" title="Fury"></a>
                <a class="button icon flex" selected="true" onclick="sendData('set-mode=wink');"><img src="./img/default.png" alt="Wink" title="Wink"></a>
                <a class="button icon flex" selected="false" onclick="sendData('set-mode=sad');"><img src="./img/default.png" alt="Sad" title="Sad"></a>
            </div>
        </div>
        <div class="suit-mode-animation-controls">
            <div class="flex-align">
                <img src="./img/brightness.png" alt="Brightness">
                <span>Animation Speed:</span>
                <input type="range" min="0" max="100" value="50" class="slider" id="set-helmet-brightness">
                <span>50%</span>
            </div>
        </div>
    </section>

    <section class="audioplayer">
        <!-- <h2>Overwrite Matrix Color:</h2></br>
        <div class="wrap">
            <div class="half">
                <div class="colorPicker"></div>
            </div>
        </div> -->
        <div class="audio-player flex">
            <div class="audiofiles-horizontal" files-found="true">
                <span class="status-no-files">No Files Found! Check the SD!</span>
                <a class="button small-icon" selected="false" onclick="playAudio('1');"><img src="./img/audiovisualizer.png" alt="Music Visualizer" title="Music Visualizer"></a>
                <a class="button small-icon" selected="false" onclick="playAudio('1');"><img src="./img/audiovisualizer.png" alt="Music Visualizer" title="Music Visualizer"></a>
                <a class="button small-icon" selected="false" onclick="playAudio('1');"><img src="./img/audiovisualizer.png" alt="Music Visualizer" title="Music Visualizer"></a>
                <a class="button small-icon" selected="false" onclick="playAudio('1');"><img src="./img/audiovisualizer.png" alt="Music Visualizer" title="Music Visualizer"></a>
                <a class="button small-icon" selected="false" onclick="playAudio('1');"><img src="./img/audiovisualizer.png" alt="Music Visualizer" title="Music Visualizer"></a>
                <a class="button small-icon" selected="false" onclick="playAudio('1');"><img src="./img/audiovisualizer.png" alt="Music Visualizer" title="Music Visualizer"></a>
                <a class="button small-icon" selected="false" onclick="playAudio('1');"><img src="./img/audiovisualizer.png" alt="Music Visualizer" title="Music Visualizer"></a>
                <a class="button small-icon" selected="false" onclick="playAudio('1');"><img src="./img/audiovisualizer.png" alt="Music Visualizer" title="Music Visualizer"></a>
                <a class="button small-icon" selected="false" onclick="playAudio('1');"><img src="./img/audiovisualizer.png" alt="Music Visualizer" title="Music Visualizer"></a>
                <a class="button small-icon" selected="false" onclick="playAudio('1');"><img src="./img/audiovisualizer.png" alt="Music Visualizer" title="Music Visualizer"></a>
            </div>
            <div class="audiofiles-vertical" files-found="true">
                <span class="status-no-files">No Files Found! Check the SD!</span>
                <a class="button item" selected="false" onclick="playAudio('1');">
                    <img src="./img/audiofile-thumbnail-placeholder.jpg" alt="Thumbnail">
                    Sample Audio Track 1
                </a>
                <a class="button item" selected="false" onclick="playAudio('2');">Sample Audio Track 2</a>
                <a class="button item" selected="false" onclick="playAudio('3');">Sample Audio Track 3</a>
                <a class="button item" selected="false" onclick="playAudio('2');">Sample Audio Track 2</a>
                <a class="button item" selected="false" onclick="playAudio('3');">Sample Audio Track 3</a>
                <a class="button item" selected="false" onclick="playAudio('2');">Sample Audio Track 2</a>
                <a class="button item" selected="false" onclick="playAudio('3');">Sample Audio Track 3</a>
                <a class="button item" selected="false" onclick="playAudio('2');">Sample Audio Track 2</a>
                <a class="button item" selected="false" onclick="playAudio('3');">Sample Audio Track 3</a>
            </div>
            <div class="flex-align">
                <a class="button small-icon" onclick="playAudio('-1');">
                    <img src="./img/next.png" alt="Previous Track" title="Previous Track">
                </a>
                <a class="button small-icon" onclick="playAudio('0');">
                    <img src="./img/play.png" alt="Play / Stop" title="Play / Stop">
                </a>
                <a class="button small-icon" onclick="playAudio('1');">
                    <img src="./img/next.png" alt="Next Track" title="Next Track">
                </a>
            </div>
        </div>
    </section>

    <script>
        function toggleFullScreen() {
            var doc = window.document;
            var docEl = doc.documentElement;
            var requestFullScreen = docEl.requestFullscreen || docEl.mozRequestFullScreen || docEl.webkitRequestFullScreen || docEl.msRequestFullscreen;
            var cancelFullScreen = doc.exitFullscreen || doc.mozCancelFullScreen || doc.webkitExitFullscreen || doc.msExitFullscreen;
            if (!doc.fullscreenElement && !doc.mozFullScreenElement && !doc.webkitFullscreenElement && !doc.msFullscreenElement) {
                requestFullScreen.call(docEl);
            } else {
                cancelFullScreen.call(doc);
            }
        }

        // AJAX Requests
        function sendData(data) {
            fetch('/ajax', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded'
                },
                body: 'plain=' + encodeURIComponent(data),
            }).then(response => response.text()).then(result => {
                console.log('Server response:', result);
            }).catch(error => {
                console.error('Error:', error);
            });
        }

        function playAudio(audioFile) {
            sendData(`play-audio=${audioFile}`);
        }

        const statusBatteryPercentageText = document.getElementById('status-battery-percentage');
        const statusBatteryAmperageText = document.getElementById('status-battery-amperage');
        const statusBatteryVoltageText = document.getElementById('status-battery-voltage');
        const statusAudiofileVolumeText = document.getElementById('status-audiofile-volume');
        function setStatusBatteryPercentage(value) {
            statusBatteryPercentageText.innerText = `${Math.round(value)} %`;
        }
        function setStatusBatteryAmperage(value) {
            statusBatteryAmperageText.innerText = `${Math.round(value)}`;
        }
        function setStatusBatteryVoltage(value) {
            statusBatteryVoltageText.innerText = `${Math.round(value * 10) / 10}`;
        }
        function setStatusAudiofileVolume(value) {
            statusAudiofileVolumeText.innerText = `${Math.round(value)} %`;
        }
        var statusLoopIndex = 0;
        function statusLoop() {
            setTimeout(() => {
                setStatusBatteryPercentage(62 + Math.random() * 6);
                setStatusBatteryAmperage(Math.random() * 1000);
                setStatusBatteryVoltage(9 + Math.random() * 3);
                setStatusAudiofileVolume(Math.random() * 100);
                if (statusLoopIndex < Infinity) statusLoop();
            }, 140);
        }
        statusLoop();

        Array.from(document.getElementsByClassName('slider')).forEach(slider => {
            slider.value = slider.getAttribute('value');
            slider.addEventListener('input', function (e) {
                slider.parentNode.children[3].textContent = `${slider.value}%`;
            });
            slider.addEventListener('change', function (e) {
                sendData(`${slider.getAttribute('id')}=${slider.value / 100}`);
            });
        });

        // Color Picker
        var colorPicker = new iro.ColorPicker(".colorPicker", {
            width: 180,
            color: "rgb(255, 0, 0)",
            borderWidth: 1,
            borderColor: "#fff",
            layout: [
                { 
                    component: iro.ui.Wheel,
                    options: {
                        sliderShape: 'circle'
                    }
                },
                {
                    component: iro.ui.Slider
                }
            ],
            layoutDirection: "horizontal"
        });

        var values = document.getElementById("values");
        
        // Sends an overriden color for the selected part of the suit
        colorPicker.on(["color:init", "color:change"], function (color) {
            sendData(`set-color=${color.hexString.split('#')[1]}`);
        });
    </script>
    <!-- THREE.JS -->
    <script type="module" src="./three.js"></script>
</body>
<footer>
    <a onclick="toggleFullScreen();" class="button-fullscreen">
        <img src="./img/fullscreen.png" alt="Go Fullscreen" title="Go Fullscreen">
    </a>
</footer>
</html>